{% extends 'attendance_records/base.html' %}

{% block title %}Attendance Records - Attendance System{% endblock %}

{% block page_title %}Attendance Records{% endblock %}

{% block content %}
  {% if request.user_role != 'admin' %}
  <div class="mb-4">
    <a class="btn btn-primary" href="{% url 'attendance_records:attendance_add' %}">
      <i class="bi bi-plus-circle"></i> Add New Record
    </a>
  </div>
  {% endif %}

  {% if records %}
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th><i class="bi bi-person"></i> Student</th>
          <th><i class="bi bi-book"></i> Course</th>
          <th><i class="bi bi-calendar-week"></i> Semester</th>
          <th><i class="bi bi-hash"></i> Week</th>
          <th><i class="bi bi-check-circle"></i> Status</th>
          <th style="text-align: center;"><i class="bi bi-gear"></i> Actions</th>
        </tr>
      </thead>
      <tbody>
      {% for r in records %}
        <tr>
          <td>{{ r.student }}</td>
          <td>{{ r.course }}</td>
          <td>{{ r.get_semester_display }}</td>
          <td>Week {{ r.week }}</td>
          <td>
            <span class="badge {% if r.status == 'P' %}bg-success{% elif r.status == 'A' %}bg-danger{% else %}bg-warning{% endif %}">
              {{ r.get_status_display }}
            </span>
          </td>
          <td style="text-align: center;">
            {% if request.user_role != 'admin' %}
            <a class="btn btn-sm btn-outline-secondary" href="{% url 'attendance_records:attendance_edit' r.pk %}" title="Edit">
              <i class="bi bi-pencil"></i>
            </a>
            <a class="btn btn-sm btn-outline-danger" href="{% url 'attendance_records:attendance_delete' r.pk %}" title="Delete">
              <i class="bi bi-trash"></i>
            </a>
            {% else %}
            <span class="text-muted">View only</span>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="alert alert-info text-center" style="padding: 3rem;">
    <i class="bi bi-inbox" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
    <h5>No Attendance Records Yet</h5>
    {% if request.user_role == 'admin' %}
      <p>Use the <strong>Mark Attendance</strong> feature from the dashboard to record student attendance.</p>
      <a class="btn btn-primary" href="{% url 'attendance_records:tutor_mark' %}">
        <i class="bi bi-clipboard2-check"></i> Mark Attendance
      </a>
    {% else %}
      <p>Get started by adding your first attendance record.</p>
      <a class="btn btn-primary" href="{% url 'attendance_records:attendance_add' %}">
        <i class="bi bi-plus-circle"></i> Add Record
      </a>
    {% endif %}
  </div>
  {% endif %}
{% endblock %}
